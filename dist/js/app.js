(function(e){function t(t){for(var n,c,o=t[0],r=t[1],u=t[2],d=0,h=[];d<o.length;d++)c=o[d],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&h.push(a[c][0]),a[c]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);l&&l(t);while(h.length)h.shift()();return i.push.apply(i,u||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],n=!0,o=1;o<s.length;o++){var r=s[o];0!==a[r]&&(n=!1)}n&&(i.splice(t--,1),e=c(c.s=s[0]))}return e}var n={},a={app:0},i=[];function c(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.m=e,c.c=n,c.d=function(e,t,s){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(s,n,function(t){return e[t]}.bind(null,n));return s},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=r;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"0788":function(e,t,s){},"090a":function(e,t,s){},"156c":function(e,t,s){"use strict";s("a3f3")},"2b44":function(e,t,s){"use strict";s("51f7")},"2d30":function(e,t,s){},"51f7":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var n=s("7a23");function a(e,t,s,a,i,c){var o=Object(n["j"])("TasksList"),r=Object(n["j"])("AddTaskButton");return Object(n["f"])(),Object(n["c"])("main",null,[Object(n["e"])(o,{class:"task-list"}),Object(n["e"])(r,{class:"add-task-btn",onClicked:c.onNewTask},null,8,["onClicked"])])}var i=Object(n["n"])("data-v-3213e43a");Object(n["h"])("data-v-3213e43a");var c={class:"tasks-list"},o={key:0,class:"tasks-list__empty-label-text"},r=Object(n["e"])("p",null,"No tasks",-1),u=Object(n["e"])("p",null,"Add new task by pressing '+' button",-1),l={key:1,class:"tasks-list__list"};Object(n["g"])();var d=i((function(e,t,s,a,i,d){var h=Object(n["j"])("TaskListItem");return Object(n["f"])(),Object(n["c"])("section",c,[i.tasks.length?Object(n["d"])("",!0):(Object(n["f"])(),Object(n["c"])("div",o,[r,u])),i.tasks.length?(Object(n["f"])(),Object(n["c"])("ul",l,[(Object(n["f"])(!0),Object(n["c"])(n["a"],null,Object(n["i"])(i.tasks,(function(e){return Object(n["f"])(),Object(n["c"])("li",{class:["tasks-list__item",d.getStateClass(e.id)],key:e.id,onMouseenter:function(t){return d.onMouseover(e)}},[Object(n["e"])(h,{task:e,onChange:t[1]||(t[1]=function(e){return d.onChange(e)}),onDelete:t[2]||(t[2]=function(e){return d.onDelete(e)})},null,8,["task"])],42,["onMouseenter"])})),128))])):Object(n["d"])("",!0)])})),h=Object(n["n"])("data-v-2170490c"),f=h((function(e,t,s,a,i,c){var o=Object(n["j"])("Checkbox"),r=Object(n["j"])("EditableText"),u=Object(n["j"])("DeleteButton");return Object(n["f"])(),Object(n["c"])("div",{id:"task_id_"+s.task.id,class:"task-list-item"},[Object(n["e"])(o,{class:"task-list-item__checkbox",modelValue:i.taskStatus,"onUpdate:modelValue":[t[1]||(t[1]=function(e){return i.taskStatus=e}),c.onChange]},null,8,["modelValue","onUpdate:modelValue"]),Object(n["e"])(r,{class:"task-list-item__text",modelValue:i.taskText,"onUpdate:modelValue":[t[2]||(t[2]=function(e){return i.taskText=e}),c.onChange],taskId:s.task.id},null,8,["modelValue","taskId","onUpdate:modelValue"]),Object(n["e"])(u,{class:c.getClass(s.task.id),onDeleted:c.onDeleted},null,8,["class","onDeleted"])],8,["id"])})),k=Object(n["n"])("data-v-de13ea44");Object(n["h"])("data-v-de13ea44");var b={class:"checkbox"};Object(n["g"])();var _=k((function(e,t,s,a,i,c){return Object(n["f"])(),Object(n["c"])("div",b,[Object(n["m"])(Object(n["e"])("input",{class:"checkbox__hidden-input",type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=function(e){return i.checked=e})},null,512),[[n["k"],i.checked]]),i.checked?Object(n["d"])("",!0):(Object(n["f"])(),Object(n["c"])("span",{key:0,class:["checkbox__visible-input",c.getStateClass()],title:c.getTitle(),onClick:t[2]||(t[2]=function(e){return c.onClicked()})}," Â  ",10,["title"])),i.checked?(Object(n["f"])(),Object(n["c"])("img",{key:1,src:"/suru/icons/checked.svg",alt:"done",class:["checkbox__visible-input",c.getStateClass()],title:c.getTitle(),onClick:t[3]||(t[3]=function(e){return c.onClicked()})},null,10,["title"])):Object(n["d"])("",!0)])})),v={name:"checkbox",props:{modelValue:{type:Boolean,required:!0,default:!1}},data:function(){return{checked:this.modelValue}},methods:{getTitle:function(){return this.checked?"mark task as undone":"mark task as done"},getStateClass:function(){return this.checked?"checkbox--checked":"checkbox--unchecked"},onClicked:function(){this.checked=!this.checked,this.$emit("update:modelValue",this.checked)}}};s("2b44");v.render=_,v.__scopeId="data-v-de13ea44";var y=v,T=Object(n["n"])("data-v-058786e0");Object(n["h"])("data-v-058786e0");var p={class:"editable-text"};Object(n["g"])();var O=T((function(e,t,s,a,i,c){return Object(n["f"])(),Object(n["c"])("div",p,[Object(n["m"])(Object(n["e"])("input",{class:"editable-text__input",type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return i.text=e}),onFocus:t[2]||(t[2]=function(){return c.onFocus.apply(c,arguments)}),onChange:t[3]||(t[3]=function(){return c.emitChanges.apply(c,arguments)}),onBlur:t[4]||(t[4]=function(){return c.emitChanges.apply(c,arguments)})},null,544),[[n["l"],i.text]])])})),g=(s("a9e3"),s("c975"),s("d4ec")),j=s("bee2"),m=s("ade3"),I={INVALID_TYPE_NUMBER:new Error('Invalid value type, should be "Number"'),INVALID_TYPE_STRING:new Error('Invalid value type, should be "String"'),INVALID_TYPE_BOOLEAN:new Error('Invalid value type, should be "Boolean"'),INVALID_TYPE_FUNCTION:new Error('Invalid value type, should be "Function"'),INVALID_TYPE_OBJECT:new Error('Invalid value type, should be "Object"'),INVALID_TYPE_ARRAY:new Error('Invalid value type, should be "Array"'),LOCAL_STORAGE_NOT_FOUND:new Error("Local storage not available on this browser"),DATA_PARSING_ERROR:new Error("Error while parsing data from local storage"),CONFIGS_LOADING_ERROR:new Error("Error while loading application configs"),TASK_INVALID_ID:new Error('Any task should has id, and it should be "Number"'),TASK_NOT_FOUND:new Error("Task with specified index or id not found")},x=function(){function e(){Object(g["a"])(this,e),Object(m["a"])(this,"_focusedTaskId",null),Object(m["a"])(this,"_currentFocusedType",""),Object(m["a"])(this,"_focusableElementsTypes",["checkbox","editor","deleteBtn"])}return Object(j["a"])(e,[{key:"focusNext",value:function(e){var t=this._getNextElementType();this._setFocusByType(e,t)}},{key:"focusPrev",value:function(e){var t=this._getPrevElementType();this._setFocusByType(e,t)}},{key:"setFocusOnCheckbox",value:function(e){var t=this;setTimeout((function(){var s=t._getCheckbox(e);s&&(t._focusedTaskId=e),s.focus()}),50)}},{key:"setFocusOnEditor",value:function(e){var t=this;setTimeout((function(){var s=t._getEditor(e);s&&(t._focusedTaskId=e),s.focus()}),50)}},{key:"setFocusOnDeleteBtn",value:function(e){var t=this;setTimeout((function(){var s=t._getDeleteBtn(e);s&&(t._focusedTaskId=e),s.focus()}),50)}},{key:"looseFocus",value:function(){var e=this;this._focusedTaskId&&setTimeout((function(){var t=e._getCheckbox(e._focusedTaskId),s=e._getEditor(e._focusedTaskId),n=e._getDeleteBtn(e._focusedTaskId);t.blur(),s.blur(),n.blur(),e._focusedTaskId=null,e._currentFocusedType=""}),50)}},{key:"_getTaskElement",value:function(e){if("number"!==typeof e)throw I.INVALID_TYPE_NUMBER;return document.getElementById("task_id_"+e)}},{key:"_getCheckbox",value:function(e){var t=this._getTaskElement(e);return t.getElementsByClassName("checkbox__hidden-input")[0]}},{key:"_getEditor",value:function(e){var t=this._getTaskElement(e);return t.getElementsByClassName("editable-text__input")[0]}},{key:"_getDeleteBtn",value:function(e){var t=this._getTaskElement(e);return t.getElementsByClassName("delete-button__button")[0]}},{key:"_getNextElementType",value:function(){var e=this._focusableElementsTypes.indexOf(this._currentFocusedType),t=this._focusableElementsTypes[e+1];return t||this._focusableElementsTypes[0]}},{key:"_getPrevElementType",value:function(){var e=this._focusableElementsTypes.indexOf(this._currentFocusedType),t=this._focusableElementsTypes[e-1];return t||this._focusableElementsTypes[2]}},{key:"_setFocusByType",value:function(e,t){switch(t){case"checkbox":this._currentFocusedType="checkbox",this.setFocusOnCheckbox(e);break;case"editor":this._currentFocusedType="editor",this.setFocusOnEditor(e);break;case"deleteBtn":this._currentFocusedType="deleteBtn",this.setFocusOnDeleteBtn(e);break;default:this._currentFocusedType="checkbox",this.setFocusOnCheckbox(e);break}}},{key:"focusedTaskId",set:function(e){this._focusedTaskId=e},get:function(){return this._focusedTaskId}}]),e}(),w=new x,E={name:"EditableText",props:{modelValue:String,taskId:Number},data:function(){return{text:this.modelValue,debounce:null}},methods:{emitChanges:function(){this.$emit("update:modelValue",this.text)},onFocus:function(){w.focusedTaskId=this.taskId}}};s("9e9e");E.render=O,E.__scopeId="data-v-058786e0";var A=E,S=Object(n["n"])("data-v-6da68c09");Object(n["h"])("data-v-6da68c09");var N={class:"delete-button"},C=Object(n["e"])("img",{src:"/suru/icons/delete.svg",alt:"delete task"},null,-1);Object(n["g"])();var D=S((function(e,t,s,a,i,c){return Object(n["f"])(),Object(n["c"])("div",N,[Object(n["e"])("button",{title:"delete task",class:"delete-button__button",onClick:t[1]||(t[1]=function(t){return e.$emit("deleted")})},[C])])})),$={name:"DeleteButton",emits:{deleted:null}};s("e7d1");$.render=D,$.__scopeId="data-v-6da68c09";var B=$,F=(s("c740"),s("a434"),s("5530")),L=s("53ca"),V=s("2bd2"),R="suru:tasks-storage",P="suru:configs",K=function(){function e(){Object(g["a"])(this,e),Object(m["a"])(this,"_localStorage",null),Object(m["a"])(this,"_configs",{}),this._init()}return Object(j["a"])(e,[{key:"saveData",value:function(e){if(!Array.isArray(e))throw I.INVALID_TYPE_ARRAY;var t=JSON.stringify(e);this._localStorage.setItem(R,t)}},{key:"loadData",value:function(){var e=this._localStorage.getItem(R);try{return JSON.parse(e)||[]}catch(t){throw I.DATA_PARSING_ERROR}}},{key:"setConfig",value:function(e,t){if("string"!==typeof e)throw I.INVALID_TYPE_STRING;if("string"!==typeof t)throw I.INVALID_TYPE_STRING;this._configs[e]=t,this._saveConfigs()}},{key:"getConfig",value:function(e){if("string"!==typeof e)throw I.INVALID_TYPE_STRING;return this._configs[e]}},{key:"_init",value:function(){if(!window.localStorage)throw I.LOCAL_STORAGE_NOT_FOUND;this._localStorage=window.localStorage,this._loadConfigs()}},{key:"_loadConfigs",value:function(){var e=this._localStorage.getItem(P);try{this._configs=e&&"undefined"!==e?JSON.parse(e):{}}catch(t){throw I.CONFIGS_LOADING_ERROR}}},{key:"_saveConfigs",value:function(){var e=JSON.stringify(this._configs);this._localStorage.setItem(P,e)}}]),e}(),U=new K,Y=function(){function e(){Object(g["a"])(this,e),Object(m["a"])(this,"_tasksChanged$",new V["a"]),Object(m["a"])(this,"_taskSelected$",new V["a"]),Object(m["a"])(this,"_tasksArray",[]),Object(m["a"])(this,"_selectedTask",null),this._init()}return Object(j["a"])(e,[{key:"tasks",get:function(){return this._tasksChanged$},set:function(e){this._tasksArray=e,this._tasksChanged$.next(e)}},{key:"selectedTask",get:function(){return this._taskSelected$},set:function(e){this._selectedTask=e,this._taskSelected$.next(e)}}]),Object(j["a"])(e,[{key:"saveTasks",value:function(){U.saveData(this._tasksArray)}},{key:"refresh",value:function(){this.saveTasks(),this._init()}},{key:"getIndexById",value:function(e){if("number"!==typeof e)throw I.INVALID_TYPE_NUMBER;return this._tasksArray.findIndex((function(t){return t.id===e}))}},{key:"getIdByIndex",value:function(e){if("number"!==typeof taskId)throw I.INVALID_TYPE_NUMBER;var t=this._tasksArray[e];return t?t.id:null}},{key:"getTaskById",value:function(e){if("number"!==typeof e)throw I.INVALID_TYPE_NUMBER;var t=this.getIndexById(e);return this._tasksArray[t]||null}},{key:"getAllTasks",value:function(){return this._tasksArray}},{key:"addNewTask",value:function(){var e=this._getNewId(),t={id:e,text:"",done:!1};return this._tasksArray.push(t),e}},{key:"editTask",value:function(e){if("object"!==Object(L["a"])(e))throw I.INVALID_TYPE_OBJECT;if("number"!==typeof e.id)throw I.TASK_INVALID_ID;var t=this.getIndexById(e.id);if(-1===t)throw I.TASK_NOT_FOUND;var s=this._tasksArray[t],n=Object(F["a"])(Object(F["a"])({},s),{},{text:e.text,done:e.done});this._tasksArray.splice(t,1,n)}},{key:"deleteTask",value:function(e){if("number"!==typeof e)throw I.TASK_INVALID_ID;this._selectedTask&&this._selectedTask.id===e&&this._moveSelectedTask();var t=this.getIndexById(e);return this._tasksArray.splice(t,1),t}},{key:"getSelectedTask",value:function(){return this._selectedTask}},{key:"selectUpperTask",value:function(){if(this._selectedTask){var e=this.getIndexById(this._selectedTask.id);if(-1!==e){var t=e-1,s=this._tasksArray[t];this.selectedTask=s&&s.id?s:this._selectedTask}}}},{key:"selectLowerTask",value:function(){if(this._selectedTask){var e=this.getIndexById(this._selectedTask.id);if(-1!==e){var t=e+1,s=this._tasksArray[t];this.selectedTask=s&&s.id?s:this._selectedTask}}}},{key:"_init",value:function(){var e=U.loadData();this._selectedTask||(this._selectedTask=e.length?e[0]:null),this.tasks=e}},{key:"_getNewId",value:function(){var e=+U.getConfig("lastId")||1;return U.setConfig("lastId",e+1+""),e}},{key:"_moveSelectedTask",value:function(){var e=this.getIndexById(this._selectedTask.id);if(-1!==e){var t=this._tasksArray[e+1],s=this._tasksArray[e-1];if(t&&t.id)return void(this.selectedTask=t);if(s&&s.id)return void(this.selectedTask=s);this.selectedTask=null}}}]),e}(),M=new Y,G={name:"TaskListItem",components:{Checkbox:y,EditableText:A,DeleteButton:B},props:{task:Object},emits:{change:null,delete:null},data:function(){return{taskStatus:this.task.done,taskText:this.task.text,selectedTask:M.getSelectedTask()}},created:function(){var e=this;M.selectedTask.subscribe((function(t){e.selectedTask=t}))},methods:{getClass:function(e){return this.selectedTask&&this.selectedTask.id===e?"task-list-item__delete-button":"task-list-item__delete-button--hidden"},onChange:function(){this.taskText?this.$emit("change",{id:this.task.id,text:this.taskText,done:this.taskStatus}):this.onDeleted()},onDeleted:function(){this.$emit("delete",this.task.id)}}};s("156c");G.render=f,G.__scopeId="data-v-2170490c";var J=G,W={name:"TasksList",components:{TaskListItem:J},data:function(){return{tasks:M.getAllTasks(),selectedTask:M.getSelectedTask()}},created:function(){var e=this;M.tasks.subscribe((function(t){e.tasks=t})),M.selectedTask.subscribe((function(t){e.selectedTask=t}))},methods:{getStateClass:function(e){return this.selectedTask&&this.selectedTask.id===e?"tasks-list__item--hover":""},onChange:function(e){M.editTask(e),M.refresh()},onDelete:function(e){M.deleteTask(e),M.refresh()},onMouseover:function(e){M.selectedTask=e}}};s("c144");W.render=d,W.__scopeId="data-v-3213e43a";var q=W,z=Object(n["n"])("data-v-5167d120");Object(n["h"])("data-v-5167d120");var H=Object(n["e"])("img",{src:"/suru/icons/plus.svg",alt:"+",class:"add-task-section-container__icon"},null,-1);Object(n["g"])();var Q=z((function(e,t,s,a,i,c){return Object(n["f"])(),Object(n["c"])("section",{class:"add-task-section-container",title:"Add task button",onClick:t[1]||(t[1]=function(t){return e.$emit("clicked")})},[H])})),X={name:"AddTaskButton",emits:{clicked:null}};s("ca26");X.render=Q,X.__scopeId="data-v-5167d120";var Z=X,ee=s("6e77"),te=s("5670"),se=function(){function e(){Object(g["a"])(this,e),Object(m["a"])(this,"onTab$",new V["a"]),Object(m["a"])(this,"onEnter$",new V["a"]),Object(m["a"])(this,"onArrowUp$",new V["a"]),Object(m["a"])(this,"onArrowDown$",new V["a"]),Object(m["a"])(this,"onSpace$",new V["a"]),Object(m["a"])(this,"onDelete$",new V["a"]),Object(m["a"])(this,"onEscape$",new V["a"]),Object(m["a"])(this,"onShiftTab$",new V["a"]),Object(m["a"])(this,"_onKeydown$",null),Object(m["a"])(this,"_nextKeySubject$",new V["a"]),Object(m["a"])(this,"_nextKeySubscription",null),Object(m["a"])(this,"_nextKeyCode",null)}return Object(j["a"])(e,[{key:"startObserve",value:function(){var e=this;this._onKeydown$=Object(ee["a"])(document,"keydown").pipe(Object(te["a"])((function(t){e._filter(t)}))).subscribe()}},{key:"stopObserve",value:function(){this._onKeydown$.unsubscribe(),this._onKeydown$=null}},{key:"_filter",value:function(e){var t=this;if(!this._handleNextKeyWaiting(e))switch(e.code){case"Tab":this._prevent(e),this.onTab$.next();break;case"ShiftLeft":this._prevent(e),this._nextKeySubscription=this._listenForNextKey("Tab").subscribe((function(){t.onShiftTab$.next(),t._nextKeySubscription.unsubscribe()}));break;case"ShiftRight":this._prevent(e),this._nextKeySubscription=this._listenForNextKey("Tab").subscribe((function(){t.onShiftTab$.next(),t._nextKeySubscription.unsubscribe()}));break;case"Enter":this._prevent(e),this.onEnter$.next();break;case"ArrowUp":this._prevent(e),this.onArrowUp$.next();break;case"ArrowDown":this._prevent(e),this.onArrowDown$.next();break;case"Space":this.onSpace$.next();break;case"Delete":this._prevent(e),this.onDelete$.next();break;case"Escape":this._prevent(e),this.onEscape$.next();break;default:break}}},{key:"_listenForNextKey",value:function(e){return this._nextKeyCode=e,this._nextKeySubject$}},{key:"_handleNextKeyWaiting",value:function(e){return this._nextKeyCode===e.code?(this._nextKeyCode=null,this._prevent(e),this._nextKeySubject$.next(),!0):(this._nextKeyCode=null,!1)}},{key:"_prevent",value:function(e){e.preventDefault()}}]),e}(),ne=new se,ae={name:"App",components:{TasksList:q,AddTaskButton:Z},created:function(){var e=this;ne.startObserve(),ne.onEnter$.subscribe((function(){e.onNewTask()})),ne.onEscape$.subscribe((function(){w.looseFocus()})),ne.onArrowUp$.subscribe((function(){M.selectUpperTask(),w.looseFocus()})),ne.onArrowDown$.subscribe((function(){M.selectLowerTask(),w.looseFocus()})),ne.onSpace$.subscribe((function(){if(!w._focusedTaskId){var e=M.getSelectedTask();e&&w.setFocusOnEditor(e.id)}})),ne.onDelete$.subscribe((function(){var e=M.getSelectedTask();e&&(M.deleteTask(e.id),M.refresh())})),ne.onTab$.subscribe((function(){var e=M.getSelectedTask();e&&w.focusNext(e.id)})),ne.onShiftTab$.subscribe((function(){var e=M.getSelectedTask();e&&w.focusPrev(e.id)}))},unmounted:function(){ne.stopObserve()},methods:{onNewTask:function(){var e=M.addNewTask();M.refresh(),w.setFocusOnEditor(e)}}};s("64be");ae.render=a;var ie=ae;"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("./service-worker.js")})),Object(n["b"])(ie).mount("#app")},"64be":function(e,t,s){"use strict";s("c894")},"9e9e":function(e,t,s){"use strict";s("2d30")},a18e:function(e,t,s){},a3f3:function(e,t,s){},c144:function(e,t,s){"use strict";s("090a")},c894:function(e,t,s){},ca26:function(e,t,s){"use strict";s("a18e")},e7d1:function(e,t,s){"use strict";s("0788")}});
//# sourceMappingURL=app.js.map